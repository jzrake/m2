(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     35958,       1040]
NotebookOptionsPosition[     34370,        982]
NotebookOutlinePosition[     34728,        998]
CellTagsIndexPosition[     34685,        995]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"GenerateSourceTerms", "[", 
   RowBox[{"J_", ",", "grad_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"FluxS", ",", "\[Delta]"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Delta]", ":=", "KroneckerDelta"}], ";", "\[IndentingNewLine]", 
     RowBox[{"FluxS", ":=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          SubscriptBox["S", "i"], 
          SubscriptBox["v", "j"]}], " ", "+", " ", 
         RowBox[{"p", " ", 
          RowBox[{"\[Delta]", "[", 
           RowBox[{"i", "-", "j"}], "]"}]}], "-", 
         RowBox[{
          SubscriptBox["b", "i"], 
          RowBox[{
           SubscriptBox["B", "j"], "/", "W"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"J", ".", 
            RowBox[{
            "FluxS", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}]}],
            ")"}], ".", 
          RowBox[{"grad", "[", 
           RowBox[{"J", "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", "j"}], "\[RightDoubleBracket]"}], "]"}]}], ",", 
         
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"J", ".", 
            RowBox[{
            "FluxS", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}]}],
            ")"}], ".", 
          RowBox[{"grad", "[", 
           RowBox[{"J", "\[LeftDoubleBracket]", 
            RowBox[{"2", ",", "j"}], "\[RightDoubleBracket]"}], "]"}]}], ",", 
         
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"J", ".", 
            RowBox[{
            "FluxS", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}]}],
            ")"}], ".", 
          RowBox[{"grad", "[", 
           RowBox[{"J", "\[LeftDoubleBracket]", 
            RowBox[{"3", ",", "j"}], "\[RightDoubleBracket]"}], "]"}]}], ",", 
         
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}]}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetCFormNoPowers", "[", "expr_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "times", "}"}], ",", 
     RowBox[{"Apply", "[", 
      RowBox[{
       RowBox[{"Function", "[", 
        RowBox[{"code", ",", 
         RowBox[{"Hold", "[", 
          RowBox[{"CForm", "[", "code", "]"}], "]"}], ",", "HoldAll"}], "]"}],
        ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Hold", "[", "#", "]"}], "&"}], "[", 
         RowBox[{"expr", "/.", 
          RowBox[{
           RowBox[{
            RowBox[{"x_Symbol", "^", "y_Integer"}], "/;", 
            RowBox[{"y", ">", "1"}]}], "\[RuleDelayed]", 
           RowBox[{"times", "@@", 
            RowBox[{"Table", "[", 
             RowBox[{"x", ",", 
              RowBox[{"{", "y", "}"}]}], "]"}]}]}]}], "]"}], "/.", 
        RowBox[{"times", "\[Rule]", "Times"}]}]}], "]"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.596573416624178*^9, 3.596573479773364*^9}, {
  3.596573542293345*^9, 3.596573554426354*^9}, {3.5965735944207687`*^9, 
  3.596573633308893*^9}, {3.596573780424633*^9, 3.596573805300932*^9}, {
  3.596573880544187*^9, 3.596573933633029*^9}, {3.596574033606847*^9, 
  3.596574034107127*^9}, {3.596575080614209*^9, 3.5965751035619164`*^9}}],

Cell[CellGroupData[{

Cell["Cylindrical geometry", "Section",
 CellChangeTimes->{{3.5965741236744423`*^9, 3.596574127312907*^9}}],

Cell[CellGroupData[{

Cell["Source term density and volume integrated", "Subsection",
 CellChangeTimes->{{3.5965747973711967`*^9, 3.596574807632786*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"gradCylindrical", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[PartialD]", "r"], "#"}], ",", 
      RowBox[{
       FractionBox["1", "r"], 
       RowBox[{
        SubscriptBox["\[PartialD]", "\[Phi]"], "#"}]}], ",", 
      RowBox[{
       SubscriptBox["\[PartialD]", "z"], "#"}]}], "}"}], "&"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"JCylindrical", ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Cos", "[", "\[Phi]", "]"}], ",", 
      RowBox[{"Sin", "[", "\[Phi]", "]"}], ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
      RowBox[{"Cos", "[", "\[Phi]", "]"}], ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ToCylindrical", "=", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        SubscriptBox["v", "i"], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Simplify", "[", 
            RowBox[{"Inverse", "@", "JCylindrical"}], "]"}], ".", 
           RowBox[{"{", 
            RowBox[{"vr", ",", "v\[Phi]", ",", "vz"}], "}"}]}], ")"}], 
         "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}], ")"}], "~", "Join",
     "~", "\[IndentingNewLine]", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       SubscriptBox["S", "i"], "\[Rule]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Simplify", "[", 
           RowBox[{"Inverse", "@", "JCylindrical"}], "]"}], ".", 
          RowBox[{"{", 
           RowBox[{"Sr", ",", "S\[Phi]", ",", "Sz"}], "}"}]}], ")"}], 
        "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}], "~", "Join", "~", 
    "\[IndentingNewLine]", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       SubscriptBox["b", "i"], "\[Rule]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Simplify", "[", 
           RowBox[{"Inverse", "@", "JCylindrical"}], "]"}], ".", 
          RowBox[{"{", 
           RowBox[{"br", ",", "b\[Phi]", ",", "bz"}], "}"}]}], ")"}], 
        "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}], "~", "Join", "~", 
    "\[IndentingNewLine]", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       SubscriptBox["B", "i"], "\[Rule]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Simplify", "[", 
           RowBox[{"Inverse", "@", "JCylindrical"}], "]"}], ".", 
          RowBox[{"{", 
           RowBox[{"Br", ",", "B\[Phi]", ",", "Bz"}], "}"}]}], ")"}], 
        "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CFormSubstitutesCylindrical", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Phi]0", "\[Rule]", "f0"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Phi]1", "\[Rule]", "f1"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Sr", "\[Rule]", "S1"}], ",", 
     RowBox[{"vr", "\[Rule]", "v1"}], ",", 
     RowBox[{"Br", "\[Rule]", "b1"}], ",", 
     RowBox[{"br", "\[Rule]", "B1"}], ",", "\[IndentingNewLine]", 
     RowBox[{"S\[Phi]", "\[Rule]", "S2"}], ",", 
     RowBox[{"v\[Phi]", "\[Rule]", "v2"}], ",", 
     RowBox[{"B\[Phi]", "\[Rule]", "b2"}], ",", 
     RowBox[{"b\[Phi]", "\[Rule]", "B2"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Sz", "\[Rule]", "S3"}], ",", 
     RowBox[{"vz", "\[Rule]", "v3"}], ",", 
     RowBox[{"Bz", "\[Rule]", "b3"}], ",", 
     RowBox[{"bz", "\[Rule]", "B3"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Sin", "\[Rule]", "sin"}], ",", 
     RowBox[{"Cos", "\[Rule]", "cos"}], ",", 
     RowBox[{"W", "\[Rule]", "u0"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MakeExactVolumeCylindrical", "[", "source_", "]"}], ":=", 
  RowBox[{"Integrate", "[", 
   RowBox[{
    RowBox[{"source", 
     RowBox[{"(", "r", ")"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"r", ",", "r0", ",", "r1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Phi]", ",", "\[Phi]0", ",", "\[Phi]1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"z", ",", "z0", ",", "z1"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"CylindricalSources", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"GenerateSourceTerms", "[", 
     RowBox[{"JCylindrical", ",", "gradCylindrical"}], "]"}], "/.", 
    "ToCylindrical"}], "//", "FullSimplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"CylindricalSourcesExact", "=", 
  RowBox[{
   RowBox[{"MakeExactVolumeCylindrical", "[", "CylindricalSources", "]"}], "//",
    "FullSimplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetCFormNoPowers", "[", 
    RowBox[{"#", "/.", "CFormSubstitutesCylindrical"}], "]"}], "&"}], "/@", 
  "CylindricalSourcesExact"}]}], "Input",
 CellChangeTimes->{{3.596574040425845*^9, 3.5965740786326427`*^9}, {
  3.596574154005721*^9, 3.5965741557914963`*^9}, {3.5965741981904163`*^9, 
  3.596574198568797*^9}, {3.5965742591352882`*^9, 3.596574374834216*^9}, {
  3.5965744417514677`*^9, 3.596574465176072*^9}, {3.5965745616315117`*^9, 
  3.5965745630285873`*^9}, {3.5965745939715223`*^9, 3.59657460815626*^9}, {
  3.596574650367168*^9, 3.596574751601514*^9}, {3.596575114587825*^9, 
  3.596575244844625*^9}, {3.596575280637342*^9, 3.596575450624991*^9}, {
  3.596575542951082*^9, 3.5965755441240873`*^9}, {3.596575910411922*^9, 
  3.596575912100449*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"-", "b\[Phi]"}], " ", "B\[Phi]"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"p", "+", 
        RowBox[{"S\[Phi]", " ", "v\[Phi]"}]}], ")"}], " ", "W"}]}], 
    RowBox[{"r", " ", "W"}]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{"br", " ", "B\[Phi]"}], "-", 
     RowBox[{"Sr", " ", "v\[Phi]", " ", "W"}]}], 
    RowBox[{"r", " ", "W"}]], ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.5965740841919727`*^9, {3.596574570674879*^9, 3.596574608824235*^9}, {
   3.596574657063348*^9, 3.596574728957223*^9}, 3.59657519903957*^9, 
   3.596575246463324*^9, {3.596575286868017*^9, 3.5965753826319027`*^9}, {
   3.596575416218994*^9, 3.596575428438047*^9}, 3.5965757840107307`*^9, 
   3.5965759140379553`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "r0"}], "+", "r1"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "b\[Phi]"}], " ", "B\[Phi]"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"p", "+", 
          RowBox[{"S\[Phi]", " ", "v\[Phi]"}]}], ")"}], " ", "W"}]}], ")"}], 
     " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "z0"}], "+", "z1"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "\[Phi]0"}], "+", "\[Phi]1"}], ")"}]}], "W"], ",", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{"r0", "-", "r1"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "br"}], " ", "B\[Phi]"}], "+", 
       RowBox[{"Sr", " ", "v\[Phi]", " ", "W"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"z0", "-", "z1"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"\[Phi]0", "-", "\[Phi]1"}], ")"}]}], "W"], ",", "0"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.5965740841919727`*^9, {3.596574570674879*^9, 3.596574608824235*^9}, {
   3.596574657063348*^9, 3.596574728957223*^9}, 3.59657519903957*^9, 
   3.596575246463324*^9, {3.596575286868017*^9, 3.5965753826319027`*^9}, {
   3.596575416218994*^9, 3.596575428438047*^9}, 3.5965757840107307`*^9, 
   3.596575914091687*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Hold", "[", 
    InterpretationBox["\<\"((-f0 + f1)*(-r0 + r1)*(-(b2*B2) + u0*(p + \
S2*v2))*(-z0 + z1))/u0\"\>",
     CForm[(-$CellContext`f0 + $CellContext`f1) (-$CellContext`r0 + \
$CellContext`r1) $CellContext`u0^(-1) (-$CellContext`b2 $CellContext`B2 + \
$CellContext`u0 ($CellContext`p + $CellContext`S2 $CellContext`v2)) \
(-$CellContext`z0 + $CellContext`z1)],
     AutoDelete->True,
     Editable->True], "]"}], ",", 
   RowBox[{"Hold", "[", 
    InterpretationBox["\<\"((f0 - f1)*(r0 - r1)*(-(B1*b2) + S1*u0*v2)*(z0 - \
z1))/u0\"\>",
     CForm[($CellContext`f0 - $CellContext`f1) ($CellContext`r0 - \
$CellContext`r1) $CellContext`u0^(-1) (-$CellContext`B1 $CellContext`b2 + \
$CellContext`S1 $CellContext`u0 $CellContext`v2) ($CellContext`z0 - \
$CellContext`z1)],
     AutoDelete->True,
     Editable->True], "]"}], ",", 
   RowBox[{"Hold", "[", 
    InterpretationBox["\<\"0\"\>",
     CForm[0],
     AutoDelete->True,
     Editable->True], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.5965740841919727`*^9, {3.596574570674879*^9, 3.596574608824235*^9}, {
   3.596574657063348*^9, 3.596574728957223*^9}, 3.59657519903957*^9, 
   3.596575246463324*^9, {3.596575286868017*^9, 3.5965753826319027`*^9}, {
   3.596575416218994*^9, 3.596575428438047*^9}, 3.5965757840107307`*^9, 
   3.5965759140937243`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Volume and area measures", "Subsection",
 CellChangeTimes->{{3.596574770745476*^9, 3.596574774116458*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Integrate", "[", 
   RowBox[{"r", ",", 
    RowBox[{"{", 
     RowBox[{"r", ",", "r0", ",", "r1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Phi]", ",", "\[Phi]0", ",", "\[Phi]1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"z", ",", "z0", ",", "z1"}], "}"}]}], "]"}], "//", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Integrate", "[", 
   RowBox[{"1", ",", 
    RowBox[{"{", 
     RowBox[{"\[Phi]", ",", "\[Phi]0", ",", "\[Phi]1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"z", ",", "z0", ",", "z1"}], "}"}]}], "]"}], "//", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Integrate", "[", 
   RowBox[{"1", ",", 
    RowBox[{"{", 
     RowBox[{"z", ",", "z0", ",", "z1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"r", ",", "r0", ",", "r1"}], "}"}]}], "]"}], "//", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Integrate", "[", 
   RowBox[{"r", ",", 
    RowBox[{"{", 
     RowBox[{"r", ",", "r0", ",", "r1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Phi]", ",", "\[Phi]0", ",", "\[Phi]1"}], "}"}]}], "]"}], "//",
   "FullSimplify"}]}], "Input",
 CellChangeTimes->{
  3.596574823860488*^9, {3.596574873548223*^9, 3.596574885674889*^9}, {
   3.596574916379836*^9, 3.5965750163368893`*^9}, {3.596575880819735*^9, 
   3.59657588568262*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox["1", "2"]}], " ", 
  RowBox[{"(", 
   RowBox[{"r0", "-", "r1"}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{"r0", "+", "r1"}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{"z0", "-", "z1"}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{"\[Phi]0", "-", "\[Phi]1"}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.5965748901387367`*^9, 3.596574938603731*^9, {3.596574991693387*^9, 
   3.596575016847928*^9}, 3.596575886235675*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"z0", "-", "z1"}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{"\[Phi]0", "-", "\[Phi]1"}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.5965748901387367`*^9, 3.596574938603731*^9, {3.596574991693387*^9, 
   3.596575016847928*^9}, 3.5965758862370653`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"r0", "-", "r1"}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{"z0", "-", "z1"}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.5965748901387367`*^9, 3.596574938603731*^9, {3.596574991693387*^9, 
   3.596575016847928*^9}, 3.596575886238473*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{"r0", "-", "r1"}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{"r0", "+", "r1"}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{"\[Phi]0", "-", "\[Phi]1"}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.5965748901387367`*^9, 3.596574938603731*^9, {3.596574991693387*^9, 
   3.596575016847928*^9}, 3.5965758862864237`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Spherical geometry", "Section",
 CellChangeTimes->{{3.596574135018383*^9, 3.5965741410746393`*^9}}],

Cell[CellGroupData[{

Cell["\<\
Source term density and volume integrated\
\>", "Subsection",
 CellChangeTimes->{{3.5965747973711967`*^9, 3.596574807632786*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"gradSpherical", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[PartialD]", "r"], "#"}], ",", 
      RowBox[{
       FractionBox["1", "r"], 
       RowBox[{
        SubscriptBox["\[PartialD]", "\[Theta]"], "#"}]}], ",", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"r", " ", 
         RowBox[{"Sin", "[", "\[Theta]", "]"}]}]], 
       RowBox[{
        SubscriptBox["\[PartialD]", "\[Phi]"], "#"}]}]}], "}"}], "&"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"JSpherical", ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Sin", "[", "\[Theta]", "]"}], 
       RowBox[{"Cos", "[", "\[Phi]", "]"}]}], ",", 
      RowBox[{
       RowBox[{"Sin", "[", "\[Theta]", "]"}], 
       RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
      RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]", "]"}], 
       RowBox[{"Cos", "[", "\[Phi]", "]"}]}], ",", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]", "]"}], 
       RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
      RowBox[{"-", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
      RowBox[{"Cos", "[", "\[Phi]", "]"}], ",", "0"}], "}"}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ToSpherical", "=", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        SubscriptBox["v", "i"], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Simplify", "[", 
            RowBox[{"Inverse", "@", "JSpherical"}], "]"}], ".", 
           RowBox[{"{", 
            RowBox[{"vr", ",", "v\[Theta]", ",", "v\[Phi]"}], "}"}]}], ")"}], 
         "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}], ")"}], "~", "Join",
     "~", "\[IndentingNewLine]", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       SubscriptBox["S", "i"], "\[Rule]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Simplify", "[", 
           RowBox[{"Inverse", "@", "JSpherical"}], "]"}], ".", 
          RowBox[{"{", 
           RowBox[{"Sr", ",", "S\[Theta]", ",", "S\[Phi]"}], "}"}]}], ")"}], 
        "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}], "~", "Join", "~", 
    "\[IndentingNewLine]", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       SubscriptBox["b", "i"], "\[Rule]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Simplify", "[", 
           RowBox[{"Inverse", "@", "JSpherical"}], "]"}], ".", 
          RowBox[{"{", 
           RowBox[{"br", ",", "b\[Theta]", ",", "b\[Phi]"}], "}"}]}], ")"}], 
        "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}], "~", "Join", "~", 
    "\[IndentingNewLine]", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       SubscriptBox["B", "i"], "\[Rule]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Simplify", "[", 
           RowBox[{"Inverse", "@", "JSpherical"}], "]"}], ".", 
          RowBox[{"{", 
           RowBox[{"Br", ",", "B\[Theta]", ",", "B\[Phi]"}], "}"}]}], ")"}], 
        "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CFormSubstitutesSpherical", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Theta]0", "\[Rule]", "t0"}], ",", 
     RowBox[{"\[Phi]0", "\[Rule]", "f0"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Theta]1", "\[Rule]", "t1"}], ",", 
     RowBox[{"\[Phi]1", "\[Rule]", "f1"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Sr", "\[Rule]", "S1"}], ",", 
     RowBox[{"vr", "\[Rule]", "v1"}], ",", 
     RowBox[{"Br", "\[Rule]", "b1"}], ",", 
     RowBox[{"br", "\[Rule]", "B1"}], ",", "\[IndentingNewLine]", 
     RowBox[{"S\[Theta]", "\[Rule]", "S2"}], ",", 
     RowBox[{"v\[Theta]", "\[Rule]", "v2"}], ",", 
     RowBox[{"B\[Theta]", "\[Rule]", "b2"}], ",", 
     RowBox[{"b\[Theta]", "\[Rule]", "B2"}], ",", "\[IndentingNewLine]", 
     RowBox[{"S\[Phi]", "\[Rule]", "S3"}], ",", 
     RowBox[{"v\[Phi]", "\[Rule]", "v3"}], ",", 
     RowBox[{"B\[Phi]", "\[Rule]", "b3"}], ",", 
     RowBox[{"b\[Phi]", "\[Rule]", "B3"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Sin", "\[Rule]", "sin"}], ",", 
     RowBox[{"Cos", "\[Rule]", "cos"}], ",", 
     RowBox[{"W", "\[Rule]", "u0"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MakeExactVolumeSpherical", "[", "source_", "]"}], ":=", 
  RowBox[{"Integrate", "[", 
   RowBox[{
    RowBox[{"source", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["r", "2"], 
       RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ")"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"r", ",", "r0", ",", "r1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Theta]", ",", "\[Theta]0", ",", "\[Theta]1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Phi]", ",", "\[Phi]0", ",", "\[Phi]1"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"SphericalSources", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"GenerateSourceTerms", "[", 
     RowBox[{"JSpherical", ",", "gradSpherical"}], "]"}], "/.", 
    "ToSpherical"}], "//", "FullSimplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"SphericalSourcesExact", "=", 
  RowBox[{
   RowBox[{"MakeExactVolumeSpherical", "[", "SphericalSources", "]"}], "//", 
   "FullSimplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetCFormNoPowers", "[", 
    RowBox[{"#", "/.", "CFormSubstitutesSpherical"}], "]"}], "&"}], "/@", 
  "SphericalSourcesExact"}]}], "Input",
 CellChangeTimes->{{3.596575110122899*^9, 3.5965751672094927`*^9}, {
  3.596575464081008*^9, 3.5965754837335567`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"-", "b\[Theta]"}], " ", "B\[Theta]"}], "-", 
     RowBox[{"b\[Phi]", " ", "B\[Phi]"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "p"}], "+", 
        RowBox[{"S\[Theta]", " ", "v\[Theta]"}], "+", 
        RowBox[{"S\[Phi]", " ", "v\[Phi]"}]}], ")"}], " ", "W"}]}], 
    RowBox[{"r", " ", "W"}]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{"br", " ", "B\[Theta]"}], "-", 
     RowBox[{"Sr", " ", "v\[Theta]", " ", "W"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "b\[Phi]"}], " ", "B\[Phi]"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"p", "+", 
           RowBox[{"S\[Phi]", " ", "v\[Phi]"}]}], ")"}], " ", "W"}]}], ")"}], 
      " ", 
      RowBox[{"Cot", "[", "\[Theta]", "]"}]}]}], 
    RowBox[{"r", " ", "W"}]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{"br", " ", "B\[Phi]"}], "-", 
     RowBox[{"Sr", " ", "v\[Phi]", " ", "W"}], "+", 
     RowBox[{"b\[Theta]", " ", "B\[Phi]", " ", 
      RowBox[{"Cot", "[", "\[Theta]", "]"}]}], "-", 
     RowBox[{"S\[Theta]", " ", "v\[Phi]", " ", "W", " ", 
      RowBox[{"Cot", "[", "\[Theta]", "]"}]}]}], 
    RowBox[{"r", " ", "W"}]]}], "}"}]], "Output",
 CellChangeTimes->{3.5965747916426487`*^9, 3.596575485111684*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["r0", "2"]}], "+", 
       SuperscriptBox["r1", "2"]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"b\[Theta]", " ", "B\[Theta]"}], "+", 
       RowBox[{"b\[Phi]", " ", "B\[Phi]"}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "p"}], "+", 
          RowBox[{"S\[Theta]", " ", "v\[Theta]"}], "+", 
          RowBox[{"S\[Phi]", " ", "v\[Phi]"}]}], ")"}], " ", "W"}]}], ")"}], 
     " ", 
     RowBox[{"(", 
      RowBox[{"\[Phi]0", "-", "\[Phi]1"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]0", "]"}], "-", 
       RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], ")"}]}], 
    RowBox[{"2", " ", "W"}]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{"r0", "-", "r1"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"r0", "+", "r1"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"\[Phi]0", "-", "\[Phi]1"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"br", " ", "B\[Theta]"}], "-", 
          RowBox[{"Sr", " ", "v\[Theta]", " ", "W"}]}], ")"}], " ", 
        RowBox[{"Cos", "[", "\[Theta]0", "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "br"}], " ", "B\[Theta]"}], "+", 
          RowBox[{"Sr", " ", "v\[Theta]", " ", "W"}]}], ")"}], " ", 
        RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"b\[Phi]", " ", "B\[Phi]"}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"p", "+", 
             RowBox[{"S\[Phi]", " ", "v\[Phi]"}]}], ")"}], " ", "W"}]}], 
         ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Sin", "[", "\[Theta]0", "]"}], "-", 
          RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], ")"}]}]}], ")"}]}], 
    RowBox[{"2", " ", "W"}]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["r0", "2"]}], "+", 
       SuperscriptBox["r1", "2"]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"\[Phi]0", "-", "\[Phi]1"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "br"}], " ", "B\[Phi]"}], "+", 
          RowBox[{"Sr", " ", "v\[Phi]", " ", "W"}]}], ")"}], " ", 
        RowBox[{"Cos", "[", "\[Theta]0", "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"br", " ", "B\[Phi]"}], "-", 
          RowBox[{"Sr", " ", "v\[Phi]", " ", "W"}]}], ")"}], " ", 
        RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"b\[Theta]", " ", "B\[Phi]"}], "-", 
          RowBox[{"S\[Theta]", " ", "v\[Phi]", " ", "W"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Sin", "[", "\[Theta]0", "]"}], "-", 
          RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], ")"}]}]}], ")"}]}], 
    RowBox[{"2", " ", "W"}]]}], "}"}]], "Output",
 CellChangeTimes->{3.5965747916426487`*^9, 3.596575495509404*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Hold", "[", 
    InterpretationBox["\<\"((f0 - f1)*(b2*B2 + b3*B3 - u0*(2*p + S2*v2 + \
S3*v3))*(cos(t0) - cos(t1))*(-(r0*r0) + r1*r1))/(2.*u0)\"\>",
     CForm[
     Rational[1, 
        2] ($CellContext`f0 - $CellContext`f1) $CellContext`u0^(-1) \
($CellContext`b2 $CellContext`B2 + $CellContext`b3 $CellContext`B3 - \
$CellContext`u0 (
        2 $CellContext`p + $CellContext`S2 $CellContext`v2 + $CellContext`S3 \
$CellContext`v3)) ($CellContext`cos[$CellContext`t0] - \
$CellContext`cos[$CellContext`t1]) (-($CellContext`r0 $CellContext`r0) + \
$CellContext`r1 $CellContext`r1)],
     AutoDelete->True,
     Editable->True], "]"}], ",", 
   RowBox[{"Hold", "[", 
    InterpretationBox["\<\"((f0 - f1)*(r0 - r1)*(r0 + r1)*((B1*b2 - \
S1*u0*v2)*cos(t0) + (-(B1*b2) + S1*u0*v2)*cos(t1) + (b3*B3 - u0*(p + \
S3*v3))*(sin(t0) - sin(t1))))/(2.*u0)\"\>",
     CForm[
     Rational[1, 
        2] ($CellContext`f0 - $CellContext`f1) ($CellContext`r0 - \
$CellContext`r1) ($CellContext`r0 + $CellContext`r1) $CellContext`u0^(-1) \
(($CellContext`B1 $CellContext`b2 - $CellContext`S1 $CellContext`u0 \
$CellContext`v2) $CellContext`cos[$CellContext`t0] + (-$CellContext`B1 \
$CellContext`b2 + $CellContext`S1 $CellContext`u0 $CellContext`v2) \
$CellContext`cos[$CellContext`t1] + ($CellContext`b3 $CellContext`B3 - \
$CellContext`u0 ($CellContext`p + $CellContext`S3 $CellContext`v3)) \
($CellContext`sin[$CellContext`t0] - $CellContext`sin[$CellContext`t1]))],
     AutoDelete->True,
     Editable->True], "]"}], ",", 
   RowBox[{"Hold", "[", 
    InterpretationBox["\<\"((f0 - f1)*((-(B1*b3) + S1*u0*v3)*cos(t0) + (B1*b3 \
- S1*u0*v3)*cos(t1) + (B2*b3 - S2*u0*v3)*(sin(t0) - sin(t1)))*(-(r0*r0) + \
r1*r1))/(2.*u0)\"\>",
     CForm[
     Rational[1, 
        2] ($CellContext`f0 - $CellContext`f1) $CellContext`u0^(-1) \
((-$CellContext`B1 $CellContext`b3 + $CellContext`S1 $CellContext`u0 \
$CellContext`v3) $CellContext`cos[$CellContext`t0] + ($CellContext`B1 \
$CellContext`b3 - $CellContext`S1 $CellContext`u0 $CellContext`v3) \
$CellContext`cos[$CellContext`t1] + ($CellContext`B2 $CellContext`b3 - \
$CellContext`S2 $CellContext`u0 $CellContext`v3) \
($CellContext`sin[$CellContext`t0] - $CellContext`sin[$CellContext`t1])) \
(-($CellContext`r0 $CellContext`r0) + $CellContext`r1 $CellContext`r1)],
     AutoDelete->True,
     Editable->True], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.5965747916426487`*^9, 3.596575495512106*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Volume and area measures", "Subsection",
 CellChangeTimes->{{3.596574770745476*^9, 3.596574774116458*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Integrate", "[", 
   RowBox[{
    RowBox[{
     SuperscriptBox["r", "2"], 
     RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"r", ",", "r0", ",", "r1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Theta]", ",", "\[Theta]0", ",", "\[Theta]1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Phi]", ",", "\[Phi]0", ",", "\[Phi]1"}], "}"}]}], "]"}], "//",
   "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Integrate", "[", 
   RowBox[{
    RowBox[{
     SuperscriptBox["r", "2"], 
     RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Theta]", ",", "\[Theta]0", ",", "\[Theta]1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Phi]", ",", "\[Phi]0", ",", "\[Phi]1"}], "}"}]}], "]"}], "//",
   "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Integrate", "[", 
   RowBox[{
    RowBox[{"r", " ", 
     RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Phi]", ",", "\[Phi]0", ",", "\[Phi]1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"r", ",", "r0", ",", "r1"}], "}"}]}], "]"}], "//", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Integrate", "[", 
   RowBox[{"r", ",", 
    RowBox[{"{", 
     RowBox[{"r", ",", "r0", ",", "r1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Theta]", ",", "\[Theta]0", ",", "\[Theta]1"}], "}"}]}], "]"}],
   "//", "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.596574833932426*^9, 3.596574862075502*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "3"], " ", 
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox["r0", "3"], "-", 
    SuperscriptBox["r1", "3"]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{"\[Phi]0", "-", "\[Phi]1"}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Cos", "[", "\[Theta]0", "]"}], "-", 
    RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.5965747653942633`*^9, 3.596574866366969*^9}],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["r", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "\[Phi]0"}], "+", "\[Phi]1"}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Cos", "[", "\[Theta]0", "]"}], "-", 
    RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.5965747653942633`*^9, 3.596574866463788*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{"r0", "-", "r1"}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{"r0", "+", "r1"}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{"\[Phi]0", "-", "\[Phi]1"}], ")"}], " ", 
  RowBox[{"Sin", "[", "\[Theta]", "]"}]}]], "Output",
 CellChangeTimes->{3.5965747653942633`*^9, 3.596574866602762*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{"r0", "-", "r1"}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{"r0", "+", "r1"}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{"\[Theta]0", "-", "\[Theta]1"}], ")"}]}]], "Output",
 CellChangeTimes->{3.5965747653942633`*^9, 3.5965748666264143`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1065, 817},
WindowMargins->{{Automatic, 155}, {Automatic, 0}},
FrontEndVersion->"9.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (November 20, \
2012)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 3946, 108, 196, "Input"],
Cell[CellGroupData[{
Cell[4528, 132, 107, 1, 80, "Section"],
Cell[CellGroupData[{
Cell[4660, 137, 131, 1, 44, "Subsection"],
Cell[CellGroupData[{
Cell[4816, 142, 5909, 152, 340, "Input"],
Cell[10728, 296, 825, 22, 47, "Output"],
Cell[11556, 320, 1387, 42, 47, "Output"],
Cell[12946, 364, 1373, 31, 46, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[14368, 401, 112, 1, 44, "Subsection"],
Cell[CellGroupData[{
Cell[14505, 406, 1355, 38, 80, "Input"],
Cell[15863, 446, 467, 14, 47, "Output"],
Cell[16333, 462, 301, 8, 28, "Output"],
Cell[16637, 472, 289, 8, 28, "Output"],
Cell[16929, 482, 391, 11, 47, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[17381, 500, 105, 1, 80, "Section"],
Cell[CellGroupData[{
Cell[17511, 505, 139, 3, 44, "Subsection"],
Cell[CellGroupData[{
Cell[17675, 512, 6224, 167, 348, "Input"],
Cell[23902, 681, 1390, 40, 47, "Output"],
Cell[25295, 723, 3331, 99, 131, "Output"],
Cell[28629, 824, 2491, 49, 97, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[31169, 879, 112, 1, 44, "Subsection"],
Cell[CellGroupData[{
Cell[31306, 884, 1531, 43, 92, "Input"],
Cell[32840, 929, 444, 13, 48, "Output"],
Cell[33287, 944, 356, 10, 32, "Output"],
Cell[33646, 956, 361, 10, 47, "Output"],
Cell[34010, 968, 320, 9, 47, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
